CREATE SCHEMA IF NOT EXISTS mls;
DROP TABLE IF EXISTS mls.listings_hist;
CREATE EXTERNAL TABLE IF NOT EXISTS mls.listings_hist
( created_datetime timestamp,
 mls string,
 mls_listing_id string,
 street_address string,
 unit_type string,
 unit string,
 city string,
 `state` string,
 zip string,
 latitude decimal(9,6),
 longitude decimal(9,6),
 legal_description string,
 subdivision string,
 lot string,
 block string,
 legal_tract string,
 book string,
 `section` string,
 township string,
 `range` string,
 apn string,
 county_name string,
 fips string,
 census_tract_geo_id string,
 school_district string,
 property_type string,
 property_sub_type string,
 property_description string,
 lot_size_acres decimal(16,4),
 lot_size_sq_ft decimal(16,4),
 zoning string,
 restrictions string,
 easements string,
 water_source string,
 septic_sewer string,
 sfha string,
 gated_community string,
 hoa string,
 hoa_name string,
 hoa_management_co string,
 hoa_management_co_phone string,
 occupant_type string,
 ownership_type string,
 owner_type string,
 owner_name string,
 owner_phone string,
 year_built smallint,
 year_updated smallint,
 number_of_units int,
 living_area_sq_ft decimal(16,4),
 living_area_sq_ft_source string,
 building_style string,
 stories decimal(8,4),
 beds int,
 full_baths int,
 half_baths int,
 basement string,
 finished_basement_pct decimal(8,4),
 garage_type string,
 garage_style string,
 garage_spaces decimal(16,4),
 roof_type string,
 exterior_material string,
 foundation string,
 pool string,
 condition string,
 property_tax_appraisal decimal(16,4),
 property_tax decimal(16,4),
 property_tax_year smallint,
 hoa_dues decimal(16,4),
 hoa_dues_frequency int,
 hoa_dues_description string,
 rent_sale string,
 entry_date date,
 listing_date date,
 listing_status string,
 listing_status_detail string,
 status_date date,
 current_price decimal(16,4),
 current_price_as_of_date date,
 orig_price decimal(16,4),
 orig_listing_date date,
 contract_date date,
 closed_price decimal(16,4),
 closed_date date,
 days_on_market int,
 dom_date timestamp,
 cumulative_days_on_market int,
 sale_circumstances string,
 listing_conditions string,
 listing_url string,
 listing_image_url string,
 listing_image_url_count int,
 listing_image_url_date date,
 loan_amount decimal(16,4),
 public_remarks string,
 realtor_remarks string,
 listing_broker_name string,
 listing_broker_id string,
 listing_agent_name string,
 listing_agent_id string,
 listing_agent_phone string,
 listing_agent_email string,
 brokerage_name string,
 brokerage_phone string,
 selling_agent_name string,
 selling_agent_id string,
 commissions string,
 buyer_agent_name string,
 buyer_agent_id string,
 buyer_commission_pct decimal(8,4),
 street_address_raw string,
 city_raw string,
 state_raw string,
 zip_raw string,
 source string,
 source_reference string,
 source_listing_id string,
 source_as_of_date timestamp,
 create_timestamp timestamp,
 update_timestamp timestamp,
 load_date string,
 listing_status_old string,
 current_price_old decimal(16,4),
 source_listing_id_old string,
 street_address_raw_old string,
 property_type_old string,
 property_sub_type_old string,
 listing_status_changed_flag boolean,
 current_price_changed_flag boolean,
 source_listing_id_changed_flag boolean,
 street_address_raw_changed_flag boolean,
 property_type_changed_flag boolean,
 property_sub_type_changed_flag boolean
) COMMENT 'MLS listing history curated'
STORED AS ORC
LOCATION '/data/curated/mls/listings_hist/'
TBLPROPERTIES ("orc.compress"="ZLIB");